// https://ru.reactjs.org/docs/state-and-lifecycle.html


import React from 'react';
import ReactDOM from 'react-dom/client';
import '../styles.scss';

// const root = ReactDOM.createRoot(document.getElementById('root'));


// –í –±–æ–ª—å—à–æ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –ø–µ—Ä–µ–≥—Ä—É–∂–∞—é—Ç —Å–∏—Å—Ç–µ–º—É, –ø–æ—ç—Ç–æ–º—É –∏—Ö –Ω—É–∂–Ω–æ —á–∏—Å—Ç–∏—Ç—å.
// –î–µ–ª–∞–µ—Ç—Å—è —ç—Ç–æ —Å –ø–æ–º–æ—â—å—é lifecycle-–º–µ—Ç–æ–¥–æ–≤ `componentDidMount()` –∏ `componentWillUnmount()`  (mount - —Ä–µ–Ω–¥–µ—Ä –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –≤ DOM)

// `componentDidMount()` - –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –∫–∞–∫ —Ç–æ–ª—å–∫–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –≤–Ω–µ–¥—Ä—ë–Ω –≤ DOM
// `componentWillUnmount()` - –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –ø–µ—Ä–µ–¥ —É–¥–∞–ª–µ–Ω–∏–µ–º –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ –∏–∑ DOM
class LifecycleExample extends React.Component {
  componentDidMount() {
    this.timerID = setInterval(
        () => this.tick, 1000);
  }

  componentWillUnmount() {
    clearInterval(this.timerID);
  }
}


// –ò–Ω–æ–≥–¥–∞ —Å–±—Ä–æ—Å –∏–ª–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —ç—Ñ—Ñ–µ–∫—Ç–∞ –º–æ–∂–µ—Ç –≤—ã–∑–≤–∞—Ç—å –ø—Ä–æ–±–ª–µ–º—ã —Å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é.
// –ß—Ç–æ–±—ã –Ω–µ –≤—ã–ø–æ–ª–Ω—è—Ç—å —Ä–µ–Ω–¥–µ—Ä –∫–∞–∂–¥—ã–π —Ä–∞–∑, –≤–æ–∑–º–æ–∂–Ω–æ —Ä–µ—à–∏—Ç—å —ç—Ç–æ —Å –ø–æ–º–æ—â—å—é —Å—Ä–∞–≤–Ω–µ–Ω–∏—è `prevProps` –∏–ª–∏ `prevState`
class Example2 extends React.Component {
  componentDidMount(prevProps, prevState) {
    if (prevState.count !== this.state.count) {
      document.title = `Total count is ${this.state.count}`
    }
  }
}


// ---------------------------------------------------------------------------------------------------------------------
// –°–æ—Å—Ç–æ—è–Ω–∏—è(state) –ø–æ–∑–≤–æ–ª—è—é—Ç –∏–∑–º–µ–Ω—è—Ç—å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã, –Ω–µ –ø–µ—Ä–µ—Å–æ–∑–¥–∞–≤–∞—è –∏—Ö.
// –°–æ—Å—Ç–æ—è–Ω–∏–µ –æ–±—ä—è–≤–ª—è–µ—Ç—Å—è –≤ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞.
// –°–æ—Å—Ç–æ—è–Ω–∏–µ —ç—Ç–æ –∫–∞–∫ –ø—Ä–æ–ø—Å, –∫–æ—Ç–æ—Ä—ã–π –¥–æ—Å—Ç—É–ø–µ–Ω —Ç–æ–ª—å–∫–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º—É –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—É.
class Clock extends React.Component {
  constructor(props) {
    super(props);
    this.state = {date: new Date()}               // –ü–æ–¥–≥–æ—Ç–æ–≤–∏–ª–∏ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∫ –∏–∑–º–µ–Ω–µ–Ω–∏—é.
  }

  componentDidMount() {
    this.timerID = setInterval(
        () => this.tick, 1000);     // –ü—Ä–∏ —Ä–µ–Ω–¥–µ—Ä–µ –º–µ—Ç–æ–¥ –∑–∞–ø—É—Å—Ç–∏—Ç –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã –¥–ª—è –º–µ—Ç–æ–¥–∞ tick()
  }

  componentWillUnmount() {
    clearInterval(this.timerID);
  }

  tick() {
    this.setState({                          // tick() –∑–∞–ø—É—Å–∫–∞–µ—Ç –º–µ—Ç–æ–¥, –∫–æ—Ç–æ—Ä—ã–π –ø–µ—Ä–µ–∫–ª—é—á–∞–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ `.setState()`
      date: new Date()
    });
  }

  render() {
    return (
        <div>
          <h1>–ü—Ä–∏–≤–µ—Ç, –º–∏—Ä!</h1>
          <h2>–°–µ–π—á–∞—Å {this.state.date.toLocaleString()}.</h2>
        </div>
    );
  }
}

// root.render(<Clock />);



// –°–æ—Å—Ç–æ—è–Ω–∏–µ –ù–ï–õ–¨–ó–Ø –º–µ–Ω—è—Ç—å –≤—Ä—É—á–Ω—É—é - –∏–∑–º–µ–Ω–µ–Ω–∏–µ –Ω–µ –ø—Ä–æ–∏–∑–æ–π–¥–µ—Ç. –†–∞–∑—Ä–µ—à–µ–Ω—ã —Ç–æ–ª—å–∫–æ –ø—Ä–∏—Å–≤–∞–∏–≤–∞–Ω–∏—è –≤ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–µ.
this.state.comment = '–ü—Ä–∏–≤–µ—Ç';                          // - –ù–ï –ù–ê–î–û –¢–ê–ö
this.setState({comment: '–ü—Ä–∏–≤–µ—Ç'});                     // –≤–æ–æ, –≤–æ—Ç —ç—Ç–æ –ø–æ-–Ω–∞—à–µ–º—É.



// –¢–∫ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∏ –ø—Ä–æ–ø—Å—ã —ç—Ç–æ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ —à—Ç—É–∫–∏, –ù–ï–õ–¨–ó–Ø –æ–±—Ä–∞—â–∞—Ç—å—Å—è –∫ –Ω–∏–º –Ω–∞–ø—Ä—è–º—É—é - –æ–Ω–∏ –º–æ–≥—É—Ç –∏–∑–º–µ–Ω–∏—Ç—å—Å—è –≤–æ –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã.
// –í —Ç–∞–∫–æ–º —Å–ª—É—á–∞–µ –≤ `.setState()` –º–æ–∂–Ω–æ –ø–µ—Ä–µ–¥–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é –∏ —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –æ–±—ä–µ–∫—Ç—ã –∫–∞–∫ –∞—Ä–≥—É–º–µ–Ω—Ç—ã.
this.setState({
  counter: this.state.counter + this.props.increment,   // - —Ñ—É—É—É—É (üëé)
});

this.setState((state, props) => ({
  counter: state.counter + props.increment,             // - –º–º–º–º) (üëç)
}));



// –ö–æ–≥–¥–∞ –º—ã –≤—ã–∑—ã–≤–∞–µ–º `.setState()`, –µ–≥–æ –∞—Ä–≥—É–º–µ–Ω—Ç(–Ω–æ–≤–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ) –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç—Å—è —Å —Ç–µ–∫—É—â–∏–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞(props).
// –¢–æ –µ—Å—Ç—å –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–µ –ø–æ–ª—è –∏–ª–∏ –∏–∑–º–µ–Ω–∏—Ç—å —Å—Ç–∞—Ä—ã–µ –æ—Ç–¥–µ–ª—å–Ω—ã–º–∏ –∏–ª–∏ –æ–¥–Ω–∏–º –≤—ã–∑–æ–≤–∞–º–∏.
// –ü—Ä–æ–ø—É—â–µ–Ω–Ω—ã–µ –ø–æ–ª—è –≤ –Ω–æ–≤–æ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏ –ø—Ä–∏ —ç—Ç–æ–º –æ—Å—Ç–∞–Ω—É—Ç—Å—è –Ω–µ–∏–∑–º–µ–Ω–Ω—ã–º–∏.
class Example1 extends React.Component {
  constructor(props) {
    super(props);
    this.state = {
      posts: [],
      comments: [],
    }
  }

  componentDidMount() {
    fetchPosts().then(response => {
      this.setState({
        post: response.post,
      })
    })

    fetchComments().then(response => {
      this.setState({
        comments: response.comments,
      })
    })
  }

}


// –ö–∞–∫ —É–∂–µ –≥–æ–≤–æ—Ä–∏–ª–æ—Å—å —Ä–∞–Ω–µ–µ, —Å–æ—Å—Ç–æ—è–Ω–∏—è –∏–Ω–∫–∞–ø—Å—É–ª–∏—Ä–æ–≤–∞–Ω—ã –≤ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞—Ö.
// –ï–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π —Å–ø–æ—Å–æ–±, –∫–∞–∫ –º–æ–∂–Ω–æ –ø–µ—Ä–µ–¥–∞—Ç—å –∏—Ö - –≤–Ω–∏–∑, –¥–æ—á–µ—Ä–Ω–µ–º—É –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—É, –≤ –≤–∏–¥–µ –µ–≥–æ `props`:
<FormattedDate date={this.state.date}/>

function FormattedDate(props) {
  return <h2>–°–µ–π—á–∞—Å {props.date.toLocaleString()}.</h2>;
}